#include <iostream>
#include <cmath>
using namespace std;
struct coordinates{
    double x;
    double y;
};
struct figures{
    int sides;
    double len;
    long double sq;
    double p;
    //coordinates *c1=new coordinates[sides];
    coordinates c1[100];
};
void realloc(figures *polygon, int *n);
//figures *realloc(figures *polygon, int *n);
void square(figures *polygon);
void per(figures *polygon);
void input(figures *polygon, int *n);
//figures *input(figures *polygon, int *n);
void menu(figures *polygon, int *n);
//void output(figures *polygon);
void output(figures *polygon, int n);
void outputcoord(figures *polygon);
void maxper(figures *polygon, int *n);
void maxsquare(figures *polygon, int *n);
void coord(figures *polygon);
void newpage();
void deletefigure(figures *polygon, int *n);
//figures *deletefigure(figures *polygon, int *n);
//int checkchar(int i);
//double checkchar(double j);
int main()
{
    int n=0;
    figures *polygon=new figures[1];
    menu(polygon, &n);
    //delete [] polygon;
    return 0;
}
/*int checkchar(int i){

}*/
/*double checkchar(double j){

}*/
void realloc(figures *polygon, int *n){
//figures *realloc(figures *polygon, int *n){
    figures *pol1=new figures[(*n)];
    for(int i=0; i<((*n)); i++){
        pol1[i]=polygon[i];
        }
    polygon=new figures[*n];
    //polygon=pol1;
    for(int i=0; i<((*n)); i++){
        polygon[i]=pol1[i];
        }
    pol1=new figures[1];
    //return pol1;
}

void square(figures *polygon){
    (polygon->sq)=((double)(polygon->sides))*pow((polygon->len), 2)/(4*tan(22/(7*((double)(polygon->sides)))));
    cout << "Polygon" << polygon << " square " << (polygon->sq)<< endl;
}
void per(figures *polygon){
    //cout << "Polygon" << polygon << " sides: " << polygon->sides << " len: " << polygon->len << endl;
    (polygon->p)=(polygon->sides)*(polygon->len);
    cout << "Polygon" << polygon << " per " << polygon->p << endl;
}
void maxper(figures *polygon, int *n){
    double maxper=0;
    for(int i=0; i<(*n); i++){
        if((maxper-((polygon[i].p)))<0){
            maxper=((polygon[i].p));
        }
}
    cout<<"Polygons with maximal perimetr:"<<endl;
    for(int j=0; j<(*n); j++){
       if((polygon[j].p)==maxper){
            cout<<j<<endl;
}
}
}
void maxsquare(figures *polygon, int *n){
    double maxsq=0;
    for(int i=0; i<(*n); i++){
        if((maxsq-((polygon[i].sq)))<0){
            maxsq=((polygon[i].sq));
        }
}
    cout<<"Polygons with maximal square:"<<endl;
    for(int j=0; j<(*n); j++){
        if((polygon[j].sq)==maxsq){
            cout<<j<<endl;
}
}
}
void coord(figures *polygon){
    cout<<"Input coordinates of the first point"<<endl;
    cin>>(polygon->c1[0].x);
    cin>>(polygon->c1[0].y);
    double x0, y0, phi, R, a, at;
    R=(polygon->len)/(2*sin(22/(7*((double)polygon->sides))));
    phi=atan((polygon->c1[0].y)/(polygon->c1[0].x));
    y0=(polygon->c1[0].y)-(polygon->len)*sin(phi);
    x0=(polygon->c1[0].x)-(polygon->len)*cos(phi);
    a=sqrt(pow(x0,2)+pow(y0,2));
    for(int i=1; i<(polygon->sides); i++){
        (polygon->c1[i].x)=x0+R*cos(phi+44/7*i/((double)polygon->sides));
        (polygon->c1[i].y)=y0+R*sin(phi+44/7*i/((double)polygon->sides));
        at=sqrt(pow((polygon->c1[i].x),2)+pow((polygon->c1[i].y),2));
        if(at>a){
            cout<<"Error"<<endl;
        }
    }
}
void input(figures *polygon, int *n){
//figures *input(figures *polygon, int *n){
    (*n)++;
//figures *pol1=NULL;
    realloc(polygon, n);
  //figures *pol1=realloc(polygon, n);
    int it=1;
    while(it==1){
    cout<<"Input number of sides"<<endl;
    cin>>(polygon[(*n)-1].sides);
    if(polygon[(*n)-1].sides<=2){
        cout<<"Error. Try again."<<endl;
    }
    else{
        cout<<"Input length"<<endl;
        cin>>(polygon[(*n)-1].len);
        per(&polygon[(*n)-1]);
        square(&polygon[(*n)-1]);
        coord(&polygon[(*n)-1]);
        cout<<"Successfully added"<<endl;
        it=0;
    }
    }
  //return pol1;
}
void outputcoord(figures *polygon){
    cout<<"Coordinates:"<<endl;
    for(int i=0; i<(polygon->sides); i++){
        cout<<"("<<polygon->c1[i].x<<";"<<polygon->c1[i].y<<")"<<endl;
    }
}
/*void output(figures *polygon){
    cout<<"number of sides: "<<(polygon->sides)<<endl;
    cout<<"length of sides: "<<(polygon->len)<<endl;
    //cout<<"coordinates:"<<endl;
    //outputcoord(polygon);
    cout<<"p="<<(polygon->p)<<endl;
    cout<<"s="<<(polygon->sq)<<endl;
}*/
void output(figures *polygon, int n){
    if(n==0){
        cout<<"Empty"<<endl;
    }
    else{
    for(int i=0; i<n; i++){
    cout<<"Polygon"<<i<<endl;
    cout<<"number of sides: "<<(polygon[i].sides)<<endl;
    cout<<"length of sides: "<<(polygon[i].len)<<endl;
    outputcoord(polygon);
    cout<<"p="<<(polygon[i].p)<<endl;
    cout<<"s="<<(polygon[i].sq)<<endl;
    }
    }
}
void deletefigure(figures *polygon, int *n){
//figures *deletefigure(figures *polygon, int *n){
    //figures *pol1=NULL;
    cout<<"Select the polygon number (starting from 0)"<<endl;
            int num;
            cin>>num;
            if(num>=(*n)){
                cout<<"Error"<<endl;
            }
            else{
               for(int i=num+1; i<(*n); i++){
                    polygon[i-1]=polygon[i];
               }
               (*n)=(*n)-1;
               realloc(polygon, n);
            }
//return pol1;
}
void newpage(){
    for(int i=0; i<120; i++){
        cout<<endl;
    }
}
void menu(figures *polygon, int *n){
    int choose, it=1;
  //figures *pol1=NULL;
    while(it==1){
            cout<<"Choose your option:"<<endl;
            cout<<"1-Input new information about a polygon"<<endl;
            cout<<"2-Look through the information"<<endl;
            cout<<"3-Delete information about a polygon"<<endl;
            cout<<"4-Define maximal square or perimetr"<<endl;
            cout<<"5-Quit"<<endl;
            cin>>choose;
    newpage();
    switch(choose){
    case 1:
        input(polygon, n);
      //pol1=input(polygon, n);
        break;
        case 2:
            /*for(int i=0; i<(*n); i++){
                    output(&polygon[i]);
            }*/
            output(polygon, (*n));
            break;
            case 3:
                deletefigure(polygon, n);
             //pol1=deletefigure(polygon, n);
                break;
                case 4:
            cout<<"Choose your option."<<endl;
            cout<<"1-Define the polygon with maximal square"<<endl;
            cout<<"2-Define the polygon with maximal perimetr"<<endl;
            cout<<"3-Return to the main menu"<<endl;
            int choose2;
            cin>>choose2;
            newpage();
            switch(choose2){
                case 1:
                   maxsquare(polygon, n);
                    break;
                case 2:
                    maxper(polygon, n);
                    break;
                case 3:
                    cout<<"Returning to the main menu"<<endl;
                    newpage();
                    it=1;
                    break;
                default:
                    cout<<"Error"<<endl;
                    break;
                }
                break;
                case 5:
                    cout<<"Are you sure? (1-yes, 2-no)"<<endl;
                    int choose1;
                    cin>>choose1;
                    newpage();
                    switch(choose1){
                        case 1:
                            cout<<"The end"<<endl;
                            /*if(pol1!=NULL){
                                delete [] pol1;
                            }*/
                            delete [] polygon;
                            newpage();
                            it=0;
                            break;
                            case 2:
                                it=1;
                                break;
                                default:
                                    cout<<"Error"<<endl;
                                    break;
                                    }
                                    break;
                                    default:
                                        cout<<"Error. Try again."<<endl;
                                        break;
                                        }
                                        newpage();
 }
}
